<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Adidas - Urban Kicks</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
  <header>
    <h1>Urban Kicks</h1>
    <nav>
      <ul>
        <li><a href="index.html">Início</a></li>
        <li><a href="nike.html">Nike</a></li>
        <li><a href="adidas.html">Adidas</a></li>
        <li><a href="newbalance.html">New Balance</a></li>
        <li><a href="carrinho.html">Carrinho</a></li>
        <li><a href="contato.html">Contato</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <h2 class="section-title">Nike</h2>
    <div id="lista-produtos" class="produtos-grid">Carregando produtos...</div>
  </main>

  <script>
    const SUPABASE_URL = "https://tdltuonnhxwfynyvbqae.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRkbHR1b25uaHh3ZnlueXZicWFlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE5NjU3MTIsImV4cCI6MjA1NzU0MTcxMn0.PLHJyCX6qPjKHrpp8oK2caLEqxMNRvsp5iaaY0lst9o";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function listarProdutos() {
      let { data, error } = await supabase
        .from("produtos")
        .select("id, nome, preco, imagens")
        .in("nome", ["Nike Air Max Plus", "Nike P-6000", "Nike Air Max DN"]);

      const container = document.getElementById("lista-produtos");
      if (error || !data) {
        container.innerHTML = "<p>Erro ao carregar produtos.</p>";
        return;
      }

      container.innerHTML = data.map(produto => `
        <div class="produto-card">
          <img src="${produto.imagens}" alt="${produto.nome}" class="produto-img">
          <h3>${produto.nome}</h3>
          <p class="preco">€${produto.preco.toFixed(2)}</p>
          <button class="comprar-btn" data-id="${produto.id}">Comprar</button>
        </div>
      `).join("");
    }

    document.addEventListener("click", async (event) => {
      if (event.target.classList.contains("comprar-btn")) {
        const produtoId = parseInt(event.target.getAttribute("data-id"));

        let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
        let { data: produto, error } = await supabase
          .from("produtos")
          .select("id, nome, preco")
          .eq("id", produtoId)
          .single();

        if (!error && produto) {
          carrinho.push(produto);
          localStorage.setItem("carrinho", JSON.stringify(carrinho));
          alert("Produto adicionado ao carrinho!");
        } else {
          alert("Erro ao adicionar ao carrinho.");
        }
      }
    });

    listarProdutos();
  </script>
</body>
</html>